name: Run conftest-unittests.sh

on: [pull_request]

jobs:
  node-docker:
    runs-on: ubuntu-latest
    container:
      image: node:quay.io/cvpops/test-index:v4.10
    steps:
         - name: Log the node version
           run: |
             skopeo inspect docker://quay.io/cvpops/test-index:v4.10
  conftest:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Conftest
        uses: redhat-cop/github-actions/confbatstest@master
        with:
          tests: tests/conftest-unittests.sh
          policies: '[]' # An empty array is provided as the policies are already cloned via source.
